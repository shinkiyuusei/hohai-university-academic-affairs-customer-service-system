import{_ as X}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                   */import{p as M,d as H,r as w,s as I,au as K,l as i,f as t,g as l,m as V,w as C,A as F,I as f,av as q,z,n as j,o as n,B as S,F as J,N as Q,P as Z,aw as $,ax as tt,M as et,ah as ot}from"./index-DEMRRUfB.js";import{L as m,i as W}from"./index-8VjjxCB0.js";const at=()=>M.get("/admin/dashboard"),st={class:"dashboard"},rt={class:"dashboard-header"},lt={class:"page-title"},it={class:"stats-grid"},nt={class:"stat-card"},dt={class:"stat-icon users"},ct={class:"stat-content"},ft={class:"stat-value"},ht={class:"stat-card"},ut={class:"stat-icon documents"},bt={class:"stat-content"},vt={class:"stat-value"},pt={class:"stat-card"},gt={class:"stat-icon graph"},yt={class:"stat-content"},wt={class:"stat-value"},mt={class:"stat-card"},_t={class:"stat-icon cases"},Ct={class:"stat-content"},St={class:"stat-value"},xt={class:"stat-card"},zt={class:"stat-icon conversations"},Wt={class:"stat-content"},Tt={class:"stat-value"},Lt={class:"stat-card"},Bt={class:"stat-icon diseases"},Ot={class:"stat-content"},Dt={class:"stat-value"},kt={class:"charts-grid"},Nt={class:"chart-card"},Rt={class:"chart-content"},Yt={class:"chart-card"},At={class:"chart-content"},Ut={class:"chart-card"},Gt={class:"chart-content"},Pt={class:"chart-card"},Et={class:"chart-content"},Xt={class:"chart-card chart-card-full"},Mt={class:"chart-content"},Ht=H({__name:"Dashboard",setup(It){const _=w({totalUsers:0,totalDocuments:0,totalGraphNodes:0,totalDiseaseCases:0,totalConversations:0,totalDiseases:0}),a=w({stats:!1,documentTypeChart:!1,userTrendChart:!1,caseTypeChart:!1,caseSeverityChart:!1,conversationTrendChart:!1}),B=w(),O=w(),D=w(),k=w(),N=w();let u=null,b=null,v=null,p=null,g=null;const d=w(null),x=async()=>{try{a.value.stats=!0;const s=await at();d.value=s,_.value=s.stats}catch(s){console.error("获取统计数据失败:",s),j.error("获取统计数据失败")}finally{a.value.stats=!1}},Y=async()=>{var s;try{a.value.documentTypeChart=!0,d.value||await x();const e=((s=d.value)==null?void 0:s.documentTypeStats.map(h=>{var y;return{value:h.count,name:((y=h.file_type)==null?void 0:y.toUpperCase())||"UNKNOWN"}}))||[],r={PDF:{start:"#fecaca",middle:"#fca5a5",end:"#f87171"},DOCX:{start:"#a5f3fc",middle:"#67e8f9",end:"#22d3ee"},DOC:{start:"#ddd6fe",middle:"#c4b5fd",end:"#a78bfa"},TXT:{start:"#bbf7d0",middle:"#86efac",end:"#4ade80"},UNKNOWN:{start:"#e2e8f0",middle:"#cbd5e1",end:"#94a3b8"}},o={backgroundColor:"transparent",tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c}件 ({d}%)",backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(0, 0, 0, 0.1)",borderWidth:1,textStyle:{color:"#334155",fontSize:13,fontWeight:500},shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.1)"},legend:{orient:"horizontal",bottom:"8%",left:"center",textStyle:{color:"#64748b",fontSize:13,fontWeight:500},itemGap:20,icon:"circle",itemWidth:12,itemHeight:12},series:[{name:"文档类型",type:"pie",radius:["38%","68%"],center:["50%","40%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:12,shadowBlur:22,shadowColor:"rgba(0, 0, 0, 0.12)",shadowOffsetY:5},label:{show:!0,position:"outside",formatter:`{b}
{c}件`,fontSize:12,fontWeight:600,color:"#475569",distance:12},emphasis:{label:{show:!0,fontSize:14,fontWeight:700,color:"#1e293b"},itemStyle:{shadowBlur:30,shadowOffsetX:0,shadowOffsetY:8,shadowColor:"rgba(0, 0, 0, 0.18)"},scale:!0,scaleSize:10},labelLine:{show:!0,lineStyle:{color:"#cbd5e1",width:2},length:18,length2:12},data:e.map(h=>{const y=r[h.name]||r.UNKNOWN;return{...h,itemStyle:{color:new m(0,0,1,1,[{offset:0,color:y.start},{offset:.5,color:y.middle},{offset:1,color:y.end}]),borderRadius:12,shadowBlur:22,shadowColor:"rgba(0, 0, 0, 0.12)",shadowOffsetY:5}}})}]};u=W(B.value),u.setOption(o)}catch(e){console.error("初始化文档类型分布图表失败:",e)}finally{a.value.documentTypeChart=!1}},A=async()=>{var s;try{a.value.userTrendChart=!0,d.value||await x();const{months:e,counts:r}=((s=d.value)==null?void 0:s.userTrendData)||{months:[],counts:[]},o={backgroundColor:"transparent",tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#cbd5e1",width:1,type:"dashed"}},backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(0, 0, 0, 0.1)",borderWidth:1,textStyle:{color:"#334155",fontSize:13,fontWeight:500},shadowBlur:15,shadowColor:"rgba(0, 0, 0, 0.1)",padding:[12,16]},grid:{left:"5%",right:"5%",bottom:"10%",top:"8%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:e,axisLine:{lineStyle:{color:"#e2e8f0",width:2}},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:12,fontWeight:500,margin:12}},yAxis:{type:"value",splitLine:{lineStyle:{color:"#f1f5f9",width:1,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:12,fontWeight:500}},series:[{name:"新增用户数",type:"line",smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{width:4,color:new m(0,0,1,0,[{offset:0,color:"#95de64"},{offset:1,color:"#52c41a"}]),shadowBlur:10,shadowColor:"rgba(82, 196, 26, 0.3)",shadowOffsetY:3},itemStyle:{color:"#fff",borderColor:"#52c41a",borderWidth:3,shadowBlur:8,shadowColor:"rgba(82, 196, 26, 0.4)"},areaStyle:{opacity:.5,color:new m(0,0,0,1,[{offset:0,color:"rgba(149, 222, 100, 0.6)"},{offset:.7,color:"rgba(82, 196, 26, 0.3)"},{offset:1,color:"rgba(82, 196, 26, 0.1)"}]),shadowBlur:20,shadowColor:"rgba(82, 196, 26, 0.1)",shadowOffsetY:10},emphasis:{focus:"series",itemStyle:{color:"#fff",borderColor:"#73d13d",borderWidth:4,shadowBlur:15,shadowColor:"rgba(115, 209, 61, 0.6)"},lineStyle:{width:5,shadowBlur:15,shadowColor:"rgba(82, 196, 26, 0.5)"}},data:r}]};b=W(O.value),b.setOption(o)}catch(e){console.error("初始化用户趋势图表失败:",e)}finally{a.value.userTrendChart=!1}},U=async()=>{var s;try{a.value.caseTypeChart=!0,d.value||await x();const e=(((s=d.value)==null?void 0:s.plantTypeStats)||[]).map(o=>({name:o.plant_type||"未分类",count:o.count||0})).filter(o=>o.count>0).sort((o,h)=>h.count-o.count),r={backgroundColor:"transparent",tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(0, 0, 0, 0.1)",borderWidth:1,textStyle:{color:"#334155",fontSize:13,fontWeight:500},shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.1)"},grid:{left:"5%",right:"5%",bottom:"5%",top:"5%",containLabel:!0},xAxis:{type:"value",splitLine:{lineStyle:{color:"#f1f5f9",width:1,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:12,fontWeight:500}},yAxis:{type:"category",data:e.map(o=>o.name),axisLine:{lineStyle:{color:"#e2e8f0",width:2}},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:12,fontWeight:500}},series:[{name:"案例数量",type:"bar",barWidth:"50%",itemStyle:{borderRadius:[0,8,8,0],color:new m(0,0,1,0,[{offset:0,color:"#95de64"},{offset:1,color:"#52c41a"}]),shadowBlur:10,shadowColor:"rgba(82, 196, 26, 0.3)",shadowOffsetX:2},emphasis:{itemStyle:{color:new m(0,0,1,0,[{offset:0,color:"#73d13d"},{offset:1,color:"#389e0d"}]),shadowBlur:15,shadowColor:"rgba(56, 158, 13, 0.4)"}},label:{show:!0,position:"right",color:"#64748b",fontSize:12,fontWeight:600},data:e.map(o=>o.count)}]};v=W(D.value),v.setOption(r)}catch(e){console.error("初始化病害案例类型分布图表失败:",e)}finally{a.value.caseTypeChart=!1}},G=async()=>{var s;try{a.value.caseSeverityChart=!0,d.value||await x();const e={轻度:1,中度:2,严重:3,特别严重:4,未标注:5},r=(((s=d.value)==null?void 0:s.severityStats)||[]).map(c=>({name:c.severity_level||"未标注",value:c.count||0,order:e[c.severity_level||"未标注"]||999})).filter(c=>c.value>0).sort((c,T)=>c.order-T.order),o={轻度:["#d9f7be","#b7eb8f","#95de64"],中度:["#fff1b8","#ffe58f","#ffd666"],严重:["#ffccc7","#ffa39e","#ff7875"],特别严重:["#ff9c9c","#ff7875","#ff4d4f"],未标注:["#f0f0f0","#d9d9d9","#bfbfbf"]},h=r.map(c=>o[c.name]||o.未标注),y={backgroundColor:"transparent",tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c}件 ({d}%)",backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(0, 0, 0, 0.1)",borderWidth:1,textStyle:{color:"#334155",fontSize:13,fontWeight:500},shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.1)"},legend:{type:"scroll",orient:"horizontal",bottom:10,left:"center",textStyle:{color:"#64748b",fontSize:13,fontWeight:500},itemGap:20,icon:"circle",itemWidth:12,itemHeight:12},series:[{name:"严重程度",type:"pie",radius:["35%","68%"],center:["50%","47%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:12,shadowBlur:22,shadowColor:"rgba(0, 0, 0, 0.12)",shadowOffsetY:5},label:{show:!0,position:"outer",alignTo:"labelLine",formatter:"{b}  {c}件",fontSize:12,fontWeight:600,color:"#475569",lineHeight:16,distanceToLabelLine:4,edgeDistance:10},emphasis:{label:{show:!0,fontSize:14,fontWeight:700,color:"#1e293b"},itemStyle:{shadowBlur:30,shadowOffsetX:0,shadowOffsetY:8,shadowColor:"rgba(0, 0, 0, 0.18)"},scale:!0,scaleSize:10},labelLine:{show:!0,smooth:!0,minTurnAngle:45,lineStyle:{color:"#cbd5e1",width:1.5,opacity:.9},length:20,length2:16},data:r.map((c,T)=>{const L=h[T%h.length];return{...c,itemStyle:{color:new m(0,0,1,1,[{offset:0,color:L[0]},{offset:.5,color:L[1]},{offset:1,color:L[2]}])}}})}]};p=W(k.value),p.setOption(y)}catch(e){console.error("初始化病害案例严重程度分布图表失败:",e)}finally{a.value.caseSeverityChart=!1}},P=async()=>{var s;try{a.value.conversationTrendChart=!0,d.value||await x();const{months:e,counts:r}=((s=d.value)==null?void 0:s.conversationTrendData)||{months:[],counts:[]},o={backgroundColor:"transparent",tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#cbd5e1",width:1,type:"dashed"}},backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(0, 0, 0, 0.1)",borderWidth:1,textStyle:{color:"#334155",fontSize:13,fontWeight:500},shadowBlur:15,shadowColor:"rgba(0, 0, 0, 0.1)",padding:[12,16]},grid:{left:"5%",right:"5%",bottom:"10%",top:"8%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:e,axisLine:{lineStyle:{color:"#e2e8f0",width:2}},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:12,fontWeight:500,margin:12}},yAxis:{type:"value",splitLine:{lineStyle:{color:"#f1f5f9",width:1,type:"dashed"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:12,fontWeight:500}},series:[{name:"新增会话数",type:"line",smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{width:4,color:new m(0,0,1,0,[{offset:0,color:"#b7eb8f"},{offset:1,color:"#73d13d"}]),shadowBlur:10,shadowColor:"rgba(115, 209, 61, 0.3)",shadowOffsetY:3},itemStyle:{color:"#fff",borderColor:"#73d13d",borderWidth:3,shadowBlur:8,shadowColor:"rgba(115, 209, 61, 0.4)"},areaStyle:{opacity:.5,color:new m(0,0,0,1,[{offset:0,color:"rgba(183, 235, 143, 0.6)"},{offset:.7,color:"rgba(115, 209, 61, 0.3)"},{offset:1,color:"rgba(115, 209, 61, 0.1)"}]),shadowBlur:20,shadowColor:"rgba(115, 209, 61, 0.1)",shadowOffsetY:10},emphasis:{focus:"series",itemStyle:{color:"#fff",borderColor:"#95de64",borderWidth:4,shadowBlur:15,shadowColor:"rgba(149, 222, 100, 0.6)"},lineStyle:{width:5,shadowBlur:15,shadowColor:"rgba(115, 209, 61, 0.5)"}},data:r}]};g=W(N.value),g.setOption(o)}catch(e){console.error("初始化问答会话趋势图表失败:",e)}finally{a.value.conversationTrendChart=!1}},R=()=>{u==null||u.resize(),b==null||b.resize(),v==null||v.resize(),p==null||p.resize(),g==null||g.resize()},E=async()=>{await x(),await Promise.all([Y(),A(),U(),G(),P()])};return I(()=>{E(),window.addEventListener("resize",R)}),K(()=>{window.removeEventListener("resize",R),u==null||u.dispose(),b==null||b.dispose(),v==null||v.dispose(),p==null||p.dispose(),g==null||g.dispose()}),(s,e)=>{const r=F,o=q;return n(),i("div",st,[t("div",rt,[t("h1",lt,[l(r,{class:"title-icon"},{default:C(()=>[l(S(J))]),_:1}),e[0]||(e[0]=V(" 系统控制台 ",-1))]),e[1]||(e[1]=t("p",{class:"page-subtitle"},"实时监控系统运行状态和数据统计",-1))]),t("div",it,[f((n(),i("div",nt,[t("div",dt,[l(r,null,{default:C(()=>[l(S(Q))]),_:1})]),t("div",ct,[t("div",ft,z(_.value.totalUsers),1),e[2]||(e[2]=t("div",{class:"stat-label"},"用户总数",-1))])])),[[o,a.value.stats]]),f((n(),i("div",ht,[t("div",ut,[l(r,null,{default:C(()=>[l(S(Z))]),_:1})]),t("div",bt,[t("div",vt,z(_.value.totalDocuments),1),e[3]||(e[3]=t("div",{class:"stat-label"},"文档总数",-1))])])),[[o,a.value.stats]]),f((n(),i("div",pt,[t("div",gt,[l(r,null,{default:C(()=>[l(S($))]),_:1})]),t("div",yt,[t("div",wt,z(_.value.totalGraphNodes),1),e[4]||(e[4]=t("div",{class:"stat-label"},"图谱节点",-1))])])),[[o,a.value.stats]]),f((n(),i("div",mt,[t("div",_t,[l(r,null,{default:C(()=>[l(S(tt))]),_:1})]),t("div",Ct,[t("div",St,z(_.value.totalDiseaseCases),1),e[5]||(e[5]=t("div",{class:"stat-label"},"病害案例",-1))])])),[[o,a.value.stats]]),f((n(),i("div",xt,[t("div",zt,[l(r,null,{default:C(()=>[l(S(et))]),_:1})]),t("div",Wt,[t("div",Tt,z(_.value.totalConversations),1),e[6]||(e[6]=t("div",{class:"stat-label"},"问答会话",-1))])])),[[o,a.value.stats]]),f((n(),i("div",Lt,[t("div",Bt,[l(r,null,{default:C(()=>[l(S(ot))]),_:1})]),t("div",Ot,[t("div",Dt,z(_.value.totalDiseases),1),e[7]||(e[7]=t("div",{class:"stat-label"},"文档总数",-1))])])),[[o,a.value.stats]])]),t("div",kt,[t("div",Nt,[e[8]||(e[8]=t("div",{class:"chart-header"},[t("h3",null,"文档类型分布")],-1)),f((n(),i("div",Rt,[t("div",{ref_key:"documentTypeChartRef",ref:B,class:"chart-container"},null,512)])),[[o,a.value.documentTypeChart]])]),t("div",Yt,[e[9]||(e[9]=t("div",{class:"chart-header"},[t("h3",null,"用户注册趋势")],-1)),f((n(),i("div",At,[t("div",{ref_key:"userTrendChartRef",ref:O,class:"chart-container"},null,512)])),[[o,a.value.userTrendChart]])]),t("div",Ut,[e[10]||(e[10]=t("div",{class:"chart-header"},[t("h3",null,"病害案例植物类型分布")],-1)),f((n(),i("div",Gt,[t("div",{ref_key:"caseTypeChartRef",ref:D,class:"chart-container"},null,512)])),[[o,a.value.caseTypeChart]])]),t("div",Pt,[e[11]||(e[11]=t("div",{class:"chart-header"},[t("h3",null,"病害案例严重程度分布")],-1)),f((n(),i("div",Et,[t("div",{ref_key:"caseSeverityChartRef",ref:k,class:"chart-container"},null,512)])),[[o,a.value.caseSeverityChart]])]),t("div",Xt,[e[12]||(e[12]=t("div",{class:"chart-header"},[t("h3",null,"问答会话创建趋势")],-1)),f((n(),i("div",Mt,[t("div",{ref_key:"conversationTrendChartRef",ref:N,class:"chart-container"},null,512)])),[[o,a.value.conversationTrendChart]])])])])}}}),jt=X(Ht,[["__scopeId","data-v-6b9ab1c6"]]);export{jt as default};
