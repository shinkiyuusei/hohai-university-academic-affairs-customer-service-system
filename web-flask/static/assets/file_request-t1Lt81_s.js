import{aO as l,n as a}from"./index-CK_LbvG7.js";const s=l.create({baseURL:"http://localhost:5010",timeout:1e4});s.interceptors.request.use(e=>{const r=localStorage.getItem("token");return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));s.interceptors.response.use(e=>{if(e.config.responseType==="blob")return e.data;const{code:r,msg:t,data:n}=e.data;return r===200?n:(a.error(t||"请求失败"),Promise.reject(new Error(t||"请求失败")))},e=>{var r,t;return((r=e.config)==null?void 0:r.responseType)==="blob"&&((t=e.response)!=null&&t.data)?new Promise((n,o)=>{const i=new FileReader;i.onload=()=>{try{const p=JSON.parse(i.result);a.error(p.msg||"下载失败"),o(new Error(p.msg||"下载失败"))}catch{a.error("下载失败"),o(new Error("下载失败"))}},i.onerror=()=>{a.error("下载失败"),o(new Error("下载失败"))},i.readAsText(e.response.data)}):(a.error(e.message||"请求失败"),Promise.reject(e))});const c={upload(e,r,t,n){const o=new FormData;return o.append("file",r),t&&o.append("is_cache","true"),s.post(`/api/file/upload/${e}`,o,{headers:{"Content-Type":"multipart/form-data"},...n})},get(e,r,t){return s.get(`/api/file/${e}/${r}`,{responseType:"blob",...t})},delete(e,r,t){return s.delete(`/api/file/${e}/${r}`,t)},getFileUrl(e,r){return`http://localhost:5010/api/file/${e}/${r}`}};export{c as f};
