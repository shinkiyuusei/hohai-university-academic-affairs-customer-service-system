import{_ as se}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                      *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                 *//* empty css                *//* empty css                     *//* empty css                  */import{d as re,r as u,s as ne,l as C,g as a,w as t,ab as ue,ac as de,ay as ie,n as _,o as c,I as pe,f as v,E as me,h as ve,i as ge,j as I,az as fe,O as B,aa as T,aA as ce,k as be,m as r,av as ye,c as $,aB as _e,y as Ve,z as D,x as L,aC as we,aD as ke,aE as Ce,at as xe,aF as Ue,ai as M,aG as he,aH as ze}from"./index-DEMRRUfB.js";const Ee={class:"user-management"},Ne={class:"card-header"},Se={class:"pagination"},Be={class:"dialog-footer"},Te={class:"dialog-footer"},$e=re({__name:"UserManagement",setup(De){const d=u({username:"",realName:"",role:void 0,status:void 0}),P=[{label:"管理员",value:1},{label:"普通用户",value:0}],O=[{label:"正常",value:1},{label:"禁用",value:0}],R=u([]),w=u(!1),n=u({current:1,size:10,total:0}),b=u(!1),y=u("add"),x=u(!1),U=u(),s=u({id:void 0,username:"",password:"",realName:"",phone:"",email:"",role:0}),K={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应在3-20个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度应在6-20个字符之间",trigger:"blur"}],realName:[{required:!0,message:"请输入真实姓名",trigger:"blur"},{min:2,max:20,message:"真实姓名长度应在2-20个字符之间",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},V=u(!1),h=u(!1),z=u(),g=async()=>{try{w.value=!0;const o={current:n.value.current,size:n.value.size,...d.value},e=await ie(o);R.value=e.records,n.value.total=e.total}catch(o){console.error("加载数据失败:",o),_.error("加载数据失败")}finally{w.value=!1}},k=()=>{n.value.current=1,g()},Z=()=>{d.value={username:"",realName:"",role:void 0,status:void 0},k()},j=o=>{n.value.current=o,g()},G=o=>{n.value.size=o,n.value.current=1,g()},H=()=>{y.value="add",s.value={id:void 0,username:"",password:"",realName:"",phone:"",email:"",role:0},b.value=!0},J=o=>{y.value="edit",s.value={id:o.id,username:o.username,password:"",realName:o.realName||"",phone:o.phone||"",email:o.email||"",role:o.role},b.value=!0},Q=async()=>{if(U.value)try{await U.value.validate(),x.value=!0,y.value==="add"?(await Ce(s.value),_.success("添加成功")):(await xe(s.value),_.success("更新成功")),b.value=!1,g()}catch(o){console.error("提交失败:",o)}finally{x.value=!1}},W=o=>{z.value=o.id,V.value=!0},X=async()=>{if(z.value)try{h.value=!0,await Ue(z.value),_.success("密码已重置为：123456"),V.value=!1}catch(o){console.error("重置密码失败:",o)}finally{h.value=!1}},Y=async o=>{try{await M.confirm(`确定要${o.status===1?"禁用":"启用"}该用户吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await he({id:o.id,status:o.status===1?0:1}),_.success(`${o.status===1?"禁用":"启用"}成功`),g()}catch(e){console.error("操作失败:",e)}},ee=async o=>{try{await M.confirm("确定要删除该用户吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ze(o.id),_.success("删除成功"),g()}catch(e){console.error("删除失败:",e)}};return ne(()=>{g()}),(o,e)=>{const i=be,f=ge,p=ve,E=ce,N=fe,F=me,m=_e,q=Ve,le=we,ae=ke,te=ue,A=de,oe=ye;return c(),C("div",Ee,[a(te,null,{header:t(()=>[v("div",Ne,[e[17]||(e[17]=v("span",null,"用户管理",-1)),a(i,{type:"primary",onClick:H},{default:t(()=>[...e[16]||(e[16]=[r(" 添加用户 ",-1)])]),_:1})])]),default:t(()=>[a(F,{model:d.value,inline:"",class:"search-form",id:"searchForm"},{default:t(()=>[a(p,{label:"用户名"},{default:t(()=>[a(f,{modelValue:d.value.username,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value.username=l),placeholder:"请输入用户名",clearable:"",onKeyup:I(k,["enter"])},null,8,["modelValue"])]),_:1}),a(p,{label:"真实姓名"},{default:t(()=>[a(f,{modelValue:d.value.realName,"onUpdate:modelValue":e[1]||(e[1]=l=>d.value.realName=l),placeholder:"请输入真实姓名",clearable:"",onKeyup:I(k,["enter"])},null,8,["modelValue"])]),_:1}),a(p,{label:"角色"},{default:t(()=>[a(N,{modelValue:d.value.role,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value.role=l),placeholder:"请选择角色",clearable:"",style:{width:"140px"},"popper-class":"role-select-dropdown",id:"searchRoleSelect"},{default:t(()=>[(c(),C(B,null,T(P,l=>a(E,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"状态"},{default:t(()=>[a(N,{modelValue:d.value.status,"onUpdate:modelValue":e[3]||(e[3]=l=>d.value.status=l),placeholder:"请选择状态",clearable:"",style:{width:"140px"},"popper-class":"status-select-dropdown",id:"searchStatusSelect"},{default:t(()=>[(c(),C(B,null,T(O,l=>a(E,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(p,null,{default:t(()=>[a(i,{type:"primary",loading:w.value,onClick:k},{default:t(()=>[...e[18]||(e[18]=[r(" 搜索 ",-1)])]),_:1},8,["loading"]),a(i,{onClick:Z},{default:t(()=>[...e[19]||(e[19]=[r(" 重置 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),pe((c(),$(le,{data:R.value,style:{width:"100%"}},{default:t(()=>[a(m,{prop:"username",label:"用户名","min-width":"120"}),a(m,{prop:"realName",label:"真实姓名","min-width":"120"}),a(m,{prop:"phone",label:"手机号",width:"120"}),a(m,{prop:"email",label:"邮箱","min-width":"180"}),a(m,{prop:"role",label:"角色",width:"100"},{default:t(({row:l})=>[a(q,{type:l.role===1?"danger":"info"},{default:t(()=>[r(D(l.role===1?"管理员":"普通用户"),1)]),_:2},1032,["type"])]),_:1}),a(m,{prop:"status",label:"状态",width:"100"},{default:t(({row:l})=>[a(q,{type:l.status===1?"success":"info"},{default:t(()=>[r(D(l.status===1?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),a(m,{prop:"createTime",label:"创建时间",width:"180"}),a(m,{label:"操作",width:"250",fixed:"right"},{default:t(({row:l})=>[a(i,{type:"primary",link:"",onClick:S=>J(l)},{default:t(()=>[...e[20]||(e[20]=[r(" 编辑 ",-1)])]),_:1},8,["onClick"]),a(i,{type:"primary",link:"",onClick:S=>W(l)},{default:t(()=>[...e[21]||(e[21]=[r(" 重置密码 ",-1)])]),_:1},8,["onClick"]),a(i,{type:l.status===1?"danger":"success",link:"",onClick:S=>Y(l)},{default:t(()=>[r(D(l.status===1?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),l.role!==1?(c(),$(i,{key:0,type:"danger",link:"",onClick:S=>ee(l)},{default:t(()=>[...e[22]||(e[22]=[r(" 删除 ",-1)])]),_:1},8,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])),[[oe,w.value]]),v("div",Se,[a(ae,{"current-page":n.value.current,"onUpdate:currentPage":e[4]||(e[4]=l=>n.value.current=l),"page-size":n.value.size,"onUpdate:pageSize":e[5]||(e[5]=l=>n.value.size=l),total:n.value.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:G,onCurrentChange:j},null,8,["current-page","page-size","total"])])]),_:1}),a(A,{modelValue:b.value,"onUpdate:modelValue":e[13]||(e[13]=l=>b.value=l),title:y.value==="add"?"添加用户":"编辑用户",width:"500px"},{footer:t(()=>[v("span",Be,[a(i,{onClick:e[12]||(e[12]=l=>b.value=!1)},{default:t(()=>[...e[23]||(e[23]=[r("取消",-1)])]),_:1}),a(i,{type:"primary",loading:x.value,onClick:Q},{default:t(()=>[...e[24]||(e[24]=[r(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:t(()=>[a(F,{ref_key:"formRef",ref:U,model:s.value,rules:K,"label-width":"100px",id:"userForm"},{default:t(()=>[a(p,{label:"用户名",prop:"username"},{default:t(()=>[a(f,{modelValue:s.value.username,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.username=l),disabled:y.value==="edit",placeholder:"请输入用户名"},null,8,["modelValue","disabled"])]),_:1}),y.value==="add"?(c(),$(p,{key:0,label:"密码",prop:"password"},{default:t(()=>[a(f,{modelValue:s.value.password,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.password=l),type:"password","show-password":"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1})):L("",!0),a(p,{label:"真实姓名",prop:"realName"},{default:t(()=>[a(f,{modelValue:s.value.realName,"onUpdate:modelValue":e[8]||(e[8]=l=>s.value.realName=l),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),a(p,{label:"手机号",prop:"phone"},{default:t(()=>[a(f,{modelValue:s.value.phone,"onUpdate:modelValue":e[9]||(e[9]=l=>s.value.phone=l),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),a(p,{label:"邮箱",prop:"email"},{default:t(()=>[a(f,{modelValue:s.value.email,"onUpdate:modelValue":e[10]||(e[10]=l=>s.value.email=l),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),a(p,{label:"角色",prop:"role"},{default:t(()=>[a(N,{modelValue:s.value.role,"onUpdate:modelValue":e[11]||(e[11]=l=>s.value.role=l),placeholder:"请选择角色",style:{width:"140px"},"popper-class":"role-select-dropdown",id:"formRoleSelect"},{default:t(()=>[(c(),C(B,null,T(P,l=>a(E,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),a(A,{modelValue:V.value,"onUpdate:modelValue":e[15]||(e[15]=l=>V.value=l),title:"重置密码",width:"400px",id:"resetPasswordDialog"},{footer:t(()=>[v("span",Te,[a(i,{onClick:e[14]||(e[14]=l=>V.value=!1)},{default:t(()=>[...e[25]||(e[25]=[r("取消",-1)])]),_:1}),a(i,{type:"primary",loading:h.value,onClick:X},{default:t(()=>[...e[26]||(e[26]=[r(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:t(()=>[e[27]||(e[27]=v("div",{class:"reset-password-content"},[v("p",null,"确定要重置该用户的密码吗？"),v("p",{class:"warning-text"},"重置后密码将变为：123456")],-1))]),_:1},8,["modelValue"])])}}}),Je=se($e,[["__scopeId","data-v-7195c700"]]);export{Je as default};
